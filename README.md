# AiCHE2023
Code for "A Graph Attention Network Based Approach for Interpretable and Domain-Aware Modeling of a Wellhead Water Treatment System" (AiCHE 2023)

### Abstract:
Rural communities in agricultural regions across the United States are increasingly confronted with increasing salinity and nitrate levels of their local potable groundwater sources. The water sources of many communities exceed the maximum nitrate contaminant level, and their water salinity is well above the recommended level for drinking. In order to provide safe potable water to these communities, membrane-based wellhead water treatment system was developed and deployed in multiple communities. However, given the remote locations, such wellhead water treatment systems must be autonomous and adapt to handle intermittent system operations due to the fluctuating water use patterns and unavailability of continuous manual labor. Since the operation of such water treatment systems is intermittent (given the fluctuating hourly and daily water usage, and the finite local water storage volume), it is critical to develop a system performance model that is suitable for model-based control, performance forecasting, fault detection, and determination of causal relationships among process attributes. To accomplish the above, an advanced ensemble machine learning approach, based on graph neural networks with attention mechanism (GATs), was developed to describe the intermittent operational profiles of a wellhead water treatment system deployed in a small remote disadvantaged community in California.

### Implementation Details:
This method is based on the idea of Graph Attention Networks (GATs) and borrows heavily in terms of implementation from [A. Deng. et al.](https://github.com/d-ailin/GDN). We implement two versions of the model: one that uses expert knowledge to build an apriori graph structure that the model learns attention weights of, and the other that completely learns a graph structure for the system. Through evaluation on a test dataset, and RMSE values for the prediction of Salt Passage and Permeate Nitrate Concentration for the system, we show that specifying an expert-defined graph structure is useful towards faster convergence to a better predictive model for the system parameters. 

### Raw Data:
The raw data used in this work can be downloaded from this [Google Drive Link](https://drive.google.com/file/d/1c9zPA3zY_nAEzemq2m4tjUBMUoUfyepS/view?usp=sharing) 
